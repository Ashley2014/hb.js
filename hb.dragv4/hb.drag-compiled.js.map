{"version":3,"sources":["hb.drag.js"],"names":[],"mappings":"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","file":"hb.drag-compiled.js","sourcesContent":[";(function(){\r\n    \"use strict\";\r\n\r\n    function drag(dom,options){\r\n        var options=options||{};\r\n        var defaults={\r\n            maxScale:3,\r\n            minScale:0.5,\r\n            position:{\r\n                left:0,\r\n                top:0,\r\n                scale:1\r\n            },\r\n            onPinchMove:function(){\r\n                //console.log('f')\r\n            },\r\n            onPinchEnd:function(){\r\n                //console.log('f')\r\n            },\r\n            onPanMove:function(){\r\n                //console.log('f')\r\n            },\r\n            onPanEnd:function(){\r\n                //console.log('f')\r\n            },\r\n        };\r\n        this.settings = $.extend( {}, defaults, options );\r\n\r\n        if(typeof dom=='string'){\r\n            this.element=document.querySelector(dom);\r\n        }else{\r\n            this.element=dom;\r\n        }\r\n        this.$element=$(this.element);\r\n        this.init();\r\n        //console.log($el,el);\r\n    }\r\n\r\n\r\n    drag.prototype.init=function(){\r\n        var _this=this;\r\n        this.hammertime = new Hammer(this.element, {});\r\n        this.hammertime.get('pinch').set({ enable: true });\r\n        this.hammertime.get('pan').set({ direction: Hammer.DIRECTION_ALL });\r\n\r\n        var element = this.element;\r\n        var $element = this.$element;\r\n        var $elementParent = this.$element.parent();\r\n\r\n        var objWidth = $element.outerWidth();\r\n        var objHeight = $element.outerHeight();\r\n        var objParentWidth = $elementParent.innerWidth();\r\n        var objParentHeight = $elementParent.innerHeight();\r\n        var objParentBorderLeftWidth = Number($elementParent.css(\"border-left-width\").replace(/px|rem|%|em/,''));\r\n        var objParentBorderTopWidth = Number($elementParent.css(\"border-top-width\").replace(/px|rem|%|em/,''));\r\n        var objParentBorderOffsetLeft = $elementParent.offset().left;\r\n        var objParentBorderOffsetTop = $elementParent.offset().top;\r\n\r\n        var elementParentRect =$elementParent.get()[0].getBoundingClientRect();\r\n\r\n        var leftGap=objParentBorderLeftWidth+elementParentRect.left;\r\n        var topGap=objParentBorderTopWidth+elementParentRect.top;\r\n\r\n\r\n        //console.log(leftGap,topGap);\r\n\r\n        if(objParentWidth/objWidth>objParentHeight/objHeight){\r\n            this.settings.minScale=objParentWidth/objWidth;\r\n        }else{\r\n            this.settings.minScale=objParentHeight/objHeight;\r\n        }\r\n\r\n\r\n        var position=this.settings.position;\r\n\r\n\r\n        var lNow=position.left;\r\n        var tNow=position.top;\r\n\r\n        var scaleNow=position.scale;\r\n        var scaleLast=0;\r\n        var center={\r\n            x:objWidth/2,\r\n            y:objHeight/2,\r\n        };\r\n        this.settings.center=center;\r\n\r\n\r\n        this.settings.constant={\r\n            leftGap:leftGap,\r\n            topGap:topGap,\r\n        };\r\n\r\n\r\n        $element.css({\r\n            transform: `translate3d(${lNow}px,${tNow}px,0)`,\r\n        });\r\n\r\n        //this.hammertime.on('swipe', function(ev) {\r\n        //    console.log('swipe',ev);\r\n        //});\r\n\r\n        this.hammertime.on('panmove', function(ev) {\r\n            //console.log('pan',ev);\r\n            //console.log('pan',lNow,tNow);\r\n\r\n            //console.log(ev.deltaX,ev.deltaY,ev.velocityX,ev.velocityY,ev.distance);\r\n\r\n            lNow=ev.deltaX+position.left;\r\n            tNow=ev.deltaY+position.top;\r\n\r\n\r\n\r\n            //lNow=(ev.deltaX+position.left)*scaleNow;\r\n            //tNow=(ev.deltaY+position.top)*scaleNow;\r\n\r\n\r\n            //if( lNow<(objParentWidth-objWidth+(objWidth-objWidth*scaleNow-(center.x-center.x*scaleNow))) ){\r\n            //    lNow=objParentWidth-objWidth+(objWidth-objWidth*scaleNow-(center.x-center.x*scaleNow))\r\n            //}\r\n            //\r\n            //\r\n            //if( tNow<(objParentHeight-objHeight+(objHeight-objHeight*scaleNow-(center.y-center.y*scaleNow))) ){\r\n            //    tNow=objParentHeight-objHeight+(objHeight-objHeight*scaleNow-(center.y-center.y*scaleNow))\r\n            //}\r\n\r\n\r\n\r\n            //\r\n            //if( lNow<(objParentWidth-objWidth) ){\r\n            //    lNow=objParentWidth-objWidth;\r\n            //}\r\n            //\r\n            //if( tNow<(objParentHeight-objHeight) ){\r\n            //    tNow=objParentHeight-objHeight;\r\n            //}\r\n\r\n\r\n\r\n            if( lNow<(objParentWidth-objWidth*scaleNow) ){\r\n                lNow=objParentWidth-objWidth*scaleNow;\r\n            }\r\n\r\n            if( tNow<(objParentHeight-objHeight*scaleNow) ){\r\n                tNow=objParentHeight-objHeight*scaleNow;\r\n            }\r\n\r\n\r\n            //if( lNow>-(center.x-center.x*scaleNow)){\r\n            //    lNow=-(center.x-center.x*scaleNow);\r\n            //}\r\n            //\r\n            //\r\n            //if( tNow>-(center.y-center.y*scaleNow)){\r\n            //    tNow=-(center.y-center.y*scaleNow);\r\n            //}\r\n\r\n\r\n            if( lNow>0){\r\n                lNow=0;\r\n            }\r\n\r\n            if( tNow>0){\r\n                tNow=0;\r\n            }\r\n\r\n\r\n\r\n\r\n\r\n            //console.log(lNow,tNow)\r\n\r\n            //\r\n            //$element.css({\r\n            //    transform: `translate3d(${lNow}px,${tNow}px,0)`,\r\n            //});\r\n            $element.css({\r\n                transform: `translate3d(${lNow}px,${tNow}px,0) scale3d(${position.scale},${position.scale},${position.scale})`,\r\n                transformOrigin: `0px 0px 0px`,\r\n            });\r\n\r\n            //console.log(lNow,tNow);\r\n            //position.left=lNow;\r\n            //position.top=tNow;\r\n            _this.settings.onPanMove({\r\n                left:lNow,\r\n                top:tNow,\r\n                scale:position.scale,\r\n            });\r\n        });\r\n\r\n        this.hammertime.on('panend', function(ev) {\r\n            position.left=lNow;\r\n            position.top=tNow;\r\n            //console.log('panpanend',lNow,tNow);\r\n            //console.log('pinch',ev);\r\n            _this.settings.onPanEnd(position);\r\n\r\n        });\r\n\r\n\r\n\r\n        this.hammertime.on('pinchstart', function(ev) {\r\n            lNow=position.left;\r\n            tNow=position.top;\r\n            //console.log('ev pinchstart',ev);\r\n            //console.log('ev.scale pinchstart',ev.scale);\r\n            elementParentRect =$elementParent.get()[0].getBoundingClientRect();\r\n            leftGap=objParentBorderLeftWidth+elementParentRect.left;\r\n            topGap=objParentBorderTopWidth+elementParentRect.top;\r\n            _this.settings.constant={\r\n                leftGap:leftGap,\r\n                topGap:topGap,\r\n            };\r\n\r\n\r\n\r\n            //center={\r\n            //    x:ev.center.x-leftGap-lNow,\r\n            //    y:ev.center.y-topGap-tNow,\r\n            //};\r\n            //console.log(center,lNow,tNow)\r\n            //$element.css({\r\n            //    transformOrigin: `${ev.center.x-leftGap-lNow}px ${ev.center.y-topGap-tNow}px 0`,\r\n            //});\r\n            scaleLast=0;\r\n        });\r\n\r\n\r\n        this.hammertime.on('pinchmove', function(ev) {\r\n            //console.log('pinch',ev);\r\n            //console.log('lNow,tNow',lNow,tNow);\r\n            //console.log('ev.scale pinchmove',ev.scale);\r\n\r\n            if(scaleLast){\r\n                var deltaScale=ev.scale-scaleLast;\r\n            }else{\r\n                var deltaScale=0;\r\n            }\r\n            //console.log('deltaScale',deltaScale);\r\n\r\n            scaleNow=position.scale+deltaScale;\r\n\r\n            if(scaleNow>_this.settings.maxScale){\r\n                scaleNow=_this.settings.maxScale;\r\n\r\n            }\r\n            if(scaleNow<_this.settings.minScale){\r\n                scaleNow=_this.settings.minScale;\r\n            }\r\n\r\n            if(scaleNow!=_this.settings.maxScale&&scaleNow!=_this.settings.minScale){\r\n\r\n\r\n                //center={\r\n                //    x:(ev.center.x-leftGap),\r\n                //    y:(ev.center.y-topGap),\r\n                //};\r\n                //\r\n                //var objCenter={\r\n                //    x:(center.x-lNow)/scaleNow,\r\n                //    y:(center.y-tNow)/scaleNow,\r\n                //}\r\n                //\r\n                //lNow=-(objCenter.x*deltaScale);\r\n                //tNow=-(objCenter.y*deltaScale);\r\n\r\n\r\n\r\n                center={\r\n                    x:(ev.center.x/scaleNow-leftGap-lNow/scaleNow),\r\n                    y:(ev.center.y/scaleNow-topGap-tNow/scaleNow),\r\n                };\r\n\r\n                lNow=-(center.x*deltaScale)+lNow;\r\n                tNow=-(center.y*deltaScale)+tNow;\r\n\r\n                //var cx=-(objParentWidth-objWidth*scaleNow)/2\r\n                //var cy=-(objParentHeight-objHeight*scaleNow)/2\r\n                ////\r\n                ////\r\n                //lNow=-cx\r\n                //tNow=-cy\r\n\r\n\r\n\r\n                //console.log('ev.center.x,leftGap,lNow',ev.center.x,leftGap,lNow);\r\n                //console.log('ev.center.y,topGap,tNow',ev.center.y,topGap,tNow);\r\n\r\n\r\n                //console.log('lNow,tNow',lNow,tNow);\r\n                //console.log('scaleNow',scaleNow);\r\n                //console.log('centerx',center.x,'centery',center.y);\r\n\r\n                //\r\n                //console.log('scaleNow',scaleNow,lNow,tNow,ev.center.x,ev.center.y);\r\n                //console.log('gap',leftGap,topGap);\r\n                //console.log('elementParentRect',elementParentRect.top,elementParentRect.left)\r\n                //console.log('$elementParent.offset()',$elementParent.offset().top)\r\n\r\n                //console.log('position.left,position.top',position.left,position.top,position.scale);\r\n                //$element.css({\r\n                //\r\n                //    transform: `translate3d(${lNow}px,${tNow}px,0) scale3d(${scaleNow},${scaleNow},${scaleNow})`,\r\n                //    transformOrigin: `${ev.center.x-leftGap-lNow}px ${ev.center.y-topGap-tNow}px 0`,\r\n                //});\r\n\r\n                $element.css({\r\n                    transform: `translate3d(${lNow}px,${tNow}px,0) scale3d(${scaleNow},${scaleNow},${scaleNow})`,\r\n                    transformOrigin: `0px 0px 0px`,\r\n                });\r\n\r\n            }\r\n\r\n\r\n\r\n            position.scale=scaleNow;\r\n            scaleLast=ev.scale;\r\n\r\n            _this.settings.onPinchMove(position);\r\n            //console.log('pinch',scaleNow,'deltaScale',deltaScale);\r\n        });\r\n\r\n        this.hammertime.on('pinchcancel', function(ev) {\r\n            //alert('pinchcancel')\r\n        })\r\n\r\n\r\n\r\n        this.hammertime.on('pinchend', function(ev) {\r\n\r\n        //    //alert(scaleNow);\r\n            position.scale=scaleNow;\r\n            scaleLast=0;\r\n        //\r\n        //\r\n        //    var maxL=objParentWidth-objWidth*scaleNow;\r\n        //    var maxT=objParentHeight-objHeight*scaleNow;\r\n        //\r\n        //    if( lNow<maxL ){\r\n        //        lNow=maxL\r\n        //    }\r\n        //\r\n        //    if( tNow<maxT ){\r\n        //        tNow=maxT\r\n        //    }\r\n        //    var minL=0;\r\n        //    var minT=0;\r\n        //\r\n        //    if(lNow<minL){\r\n        //        lNow=minL;\r\n        //    }\r\n        //    if(tNow<minT){\r\n        //        tNow=minT;\r\n        //    }\r\n        //    $element.css({\r\n        //        transform: `translate3d(${lNow}px,${tNow}px,0) scale3d(${position.scale},${position.scale},${position.scale})`,\r\n        //        transformOrigin: `0px 0px 0px`,\r\n        //    });\r\n\r\n\r\n            if( lNow<(objParentWidth-objWidth*scaleNow) ){\r\n                lNow=objParentWidth-objWidth*scaleNow;\r\n            }\r\n\r\n            if( tNow<(objParentHeight-objHeight*scaleNow) ){\r\n                tNow=objParentHeight-objHeight*scaleNow;\r\n            }\r\n\r\n            if( lNow>0){\r\n                lNow=0;\r\n            }\r\n\r\n            if( tNow>0){\r\n                tNow=0;\r\n            }\r\n\r\n            $element.css({\r\n                transform: `translate3d(${lNow}px,${tNow}px,0) scale3d(${position.scale},${position.scale},${position.scale})`,\r\n                transformOrigin: `0px 0px 0px`,\r\n            });\r\n            position.left=lNow;\r\n            position.top=tNow;\r\n            _this.settings.onPinchEnd(position);\r\n        });\r\n\r\n    };\r\n\r\n    drag.prototype.move=function(x,y){\r\n        var _this=this;\r\n        var $element = this.$element;\r\n        var position=this.settings.position;\r\n        position.left=x;\r\n        position.top=y;\r\n        $element.css({\r\n            transform: `translate3d(${x}px,${y}px,0) scale3d(${position.scale},${position.scale},${position.scale})`,\r\n        });\r\n    };\r\n\r\n    drag.prototype.scale=function(scale){\r\n        var _this=this;\r\n        var $element = this.$element;\r\n        var position=this.settings.position;\r\n        var center=this.settings.center;\r\n        var leftGap=this.settings.constant.leftGap;\r\n        var topGap=this.settings.constant.topGap;\r\n\r\n        position.scale=scale;\r\n\r\n\r\n\r\n\r\n        $element.css({\r\n            transform: `translate3d(${position.left}px,${position.top}px,0) scale3d(${scale},${scale},${scale})`,\r\n        });\r\n    };\r\n\r\n\r\n\r\n\r\n    hb.drag=function(dom,options){\r\n        return new drag(dom,options);\r\n    };\r\n}());"]}